clear all;
clc;
Gx=2;
Gy=2;
% for 8x8 elements
a0=[Gx+Gy Gx+2*Gy Gx+2*Gy Gx+2*Gy Gx+2*Gy Gx+2*Gy Gx+2*Gy Gx+Gy];
a1=-Gy*ones(1,7);

A=diag(a0,0)+diag(a1,1)+diag(a1,-1);

b0=[2*Gx+Gy 2*Gx+2*Gy 2*Gx+2*Gy 2*Gx+2*Gy 2*Gx+2*Gy 2*Gx+2*Gy 2*Gx+2*Gy 2*Gx+Gy];
b1=-Gy*ones(1,7);

B=diag(b0,0)+diag(b1,1)+diag(b1,-1);


c0=-Gx*ones(1,8);
C=diag(c0,0);

d0=ones(1,8);
D=diag(d0,0);

Z=zeros(8,8);

O=diag(ones(1,8),0);


G=[A C Z Z Z Z Z Z ;...
   C B C Z Z Z Z Z ;...
   Z C B C Z Z Z Z ;...
   Z Z C B C Z Z Z ;...
   Z Z Z C B C Z Z ;...
   Z Z Z Z C B C Z ;...
   Z Z Z Z Z C B C ;...
   Z Z Z Z Z Z Z O];

% for 25x25 elements
a0_25=[Gx+Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+2*Gy...
    Gx+Gy];
a1_25=-Gy*ones(1,24);

A_25=diag(a0_25,0)+diag(a1_25,1)+diag(a1_25,-1);
b0_25=[2*Gx+Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+2*Gy...
    2*Gx+Gy];

b1_25=-Gy*ones(1,24);

B_25=diag(b0_25,0)+diag(b1_25,1)+diag(b1_25,-1);


c0_25=-Gx*ones(1,25);
C_25=diag(c0_25,0);

d0_25=ones(1,25);
D_25=diag(d0_25,0);

Z_25=zeros(25,25);

O_25=diag(ones(1,25),0);









G_25=[A_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;... 
      Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;... 
      Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;... 
      Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 Z_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 C_25 B_25 C_25 ;...
      Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 Z_25 O_25 ...
      ];


T0=20;
I=[zeros(56,1);T0*ones(8,1)];
T1=inv(G)*I;
I(20)=45;
T2=inv(G)*I; 




I(6)=500;

I(25)=500;
I(53)=500;
T3=inv(G)*I;

I_25=[zeros(600,1);T0*ones(25,1)];
I_25(18)=1500;

I_25(355)=1500;
I_25(516)=1500;




T4=inv(G_25)*I_25;

Map1=zeros(8,8);
Map2=zeros(8,8);
Map3=zeros(8,8);
Map4=zeros(25,25);
% transfer the result to the matrix form
for i=1:8
    for j=1:8
        idx=(j-1)*8+i;
        Map1(i,j)=T1(idx);
        Map2(i,j)=T2(idx);
        Map3(i,j)=T3(idx);
    end
end


for i=1:25
    for j=1:25
        idx=(j-1)*25+i;
        Map4(i,j)=T4(idx);
    end
end
% draw the heat map

figure(1)

htmap=zeros(64,3);
htmap(1:64,1)=1;
htmap(1:64,2)=linspace(1,0,64);

colormap(htmap);

imagesc(Map1,[20 50]);
colorbar;
title('Temperature when no power add on ')
hold on
figure(2)


htmap=zeros(64,3);
htmap(1:64,1)=1;
htmap(1:64,2)=linspace(1,0,64);

colormap(htmap);
imagesc(Map2,[20 50]);
colorbar;
title('Temperature when 45W power add on ')

figure(3)


htmap=zeros(256,3);
htmap(1:256,1)=1;
htmap(1:256,2)=linspace(1,0,256);

colormap(htmap);
imagesc(Map3);
colorbar;
title('Temperature when multiple powers add on ')

figure(4)

htmap=zeros(256,3);
htmap(1:256,1)=1;
htmap(1:256,2)=linspace(1,0,256);


colormap(htmap);

%colormap(jet);
cmap = colormap;
imagesc(Map4);
colorbar;
title('Temperature when multiple powers add on 25x25 elements ')
